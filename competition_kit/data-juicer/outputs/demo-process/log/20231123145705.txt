2023-11-23 14:57:05.586 | INFO     | data_juicer.config.config:config_backup:442 - Back up the input config file [/home/kingxue/PycharmProjects/ali_FT_Data_Ranker/competition_kit/data-juicer/configs/demo/process.yaml] into the work_dir [./outputs/demo-process]
2023-11-23 14:57:05.594 | INFO     | data_juicer.config.config:display_config:463 - Configuration table: 
╒════════════════════════╤═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════╕
│ key                    │ values                                                                                                            │
╞════════════════════════╪═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════╡
│ config                 │ [Path_fr(/home/kingxue/PycharmProjects/ali_FT_Data_Ranker/competition_kit/data-juicer/configs/demo/process.yaml)] │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ hpo_config             │ None                                                                                                              │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ project_name           │ 'demo-process'                                                                                                    │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ executor_type          │ 'default'                                                                                                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_path           │ './demos/data/demo-dataset.jsonl'                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_path            │ './outputs/demo-process/demo-processed.jsonl'                                                                     │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_shard_size      │ 0                                                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_in_parallel     │ False                                                                                                             │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ np                     │ 4                                                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ text_keys              │ 'text'                                                                                                            │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ image_key              │ 'images'                                                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ image_special_token    │ '<__dj__image>'                                                                                                   │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ eoc_special_token      │ '<|__dj__eoc|>'                                                                                                   │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ suffixes               │ []                                                                                                                │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ use_cache              │ True                                                                                                              │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ ds_cache_dir           │ PosixPath('/home/kingxue/.cache/huggingface/datasets')                                                            │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ cache_compress         │ None                                                                                                              │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ use_checkpoint         │ False                                                                                                             │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ temp_dir               │ None                                                                                                              │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ open_tracer            │ False                                                                                                             │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ op_list_to_trace       │ []                                                                                                                │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ trace_num              │ 10                                                                                                                │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ op_fusion              │ False                                                                                                             │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ process                │ [{'language_id_score_filter': {'image_key': 'images',                                                             │
│                        │                                'lang': 'zh',                                                                      │
│                        │                                'min_score': 0.8,                                                                  │
│                        │                                'text_key': 'text'}}]                                                              │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ save_stats_in_one_file │ False                                                                                                             │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ ray_address            │ 'auto'                                                                                                            │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ work_dir               │ './outputs/demo-process'                                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ timestamp              │ '20231123145705'                                                                                                  │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_dir            │ '/home/kingxue/PycharmProjects/ali_FT_Data_Ranker/competition_kit/data-juicer/demos/data'                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ add_suffix             │ False                                                                                                             │
╘════════════════════════╧═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════╛
2023-11-23 14:57:07.210 | INFO     | data_juicer.config.config:config_backup:442 - Back up the input config file [/home/kingxue/PycharmProjects/ali_FT_Data_Ranker/competition_kit/data-juicer/configs/demo/process.yaml] into the work_dir [./outputs/demo-process]
2023-11-23 14:57:07.215 | INFO     | data_juicer.config.config:display_config:463 - Configuration table: 
╒════════════════════════╤═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════╕
│ key                    │ values                                                                                                            │
╞════════════════════════╪═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════╡
│ config                 │ [Path_fr(/home/kingxue/PycharmProjects/ali_FT_Data_Ranker/competition_kit/data-juicer/configs/demo/process.yaml)] │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ hpo_config             │ None                                                                                                              │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ project_name           │ 'demo-process'                                                                                                    │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ executor_type          │ 'default'                                                                                                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_path           │ './demos/data/demo-dataset.jsonl'                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_path            │ './outputs/demo-process/demo-processed.jsonl'                                                                     │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_shard_size      │ 0                                                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_in_parallel     │ False                                                                                                             │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ np                     │ 4                                                                                                                 │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ text_keys              │ 'text'                                                                                                            │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ image_key              │ 'images'                                                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ image_special_token    │ '<__dj__image>'                                                                                                   │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ eoc_special_token      │ '<|__dj__eoc|>'                                                                                                   │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ suffixes               │ []                                                                                                                │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ use_cache              │ True                                                                                                              │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ ds_cache_dir           │ PosixPath('/home/kingxue/.cache/huggingface/datasets')                                                            │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ cache_compress         │ None                                                                                                              │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ use_checkpoint         │ False                                                                                                             │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ temp_dir               │ None                                                                                                              │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ open_tracer            │ False                                                                                                             │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ op_list_to_trace       │ []                                                                                                                │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ trace_num              │ 10                                                                                                                │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ op_fusion              │ False                                                                                                             │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ process                │ [{'language_id_score_filter': {'image_key': 'images',                                                             │
│                        │                                'lang': 'zh',                                                                      │
│                        │                                'min_score': 0.8,                                                                  │
│                        │                                'text_key': 'text'}}]                                                              │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ save_stats_in_one_file │ False                                                                                                             │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ ray_address            │ 'auto'                                                                                                            │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ work_dir               │ './outputs/demo-process'                                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ timestamp              │ '20231123145707'                                                                                                  │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_dir            │ '/home/kingxue/PycharmProjects/ali_FT_Data_Ranker/competition_kit/data-juicer/demos/data'                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ add_suffix             │ False                                                                                                             │
╘════════════════════════╧═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════╛
2023-11-23 14:57:28.340 | INFO     | data_juicer.config.config:config_backup:442 - Back up the input config file [/home/kingxue/PycharmProjects/ali_FT_Data_Ranker/competition_kit/data-juicer/configs/data_juicer_recipes/alpaca_cot/alpaca-cot-en-refine.yaml] into the work_dir [../data/proc_data]
2023-11-23 14:57:28.349 | INFO     | data_juicer.config.config:display_config:463 - Configuration table: 
╒════════════════════════╤═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╕
│ key                    │ values                                                                                                                                                        │
╞════════════════════════╪═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╡
│ config                 │ [Path_fr(configs/data_juicer_recipes/alpaca_cot/alpaca-cot-en-refine.yaml, cwd=/home/kingxue/PycharmProjects/ali_FT_Data_Ranker/competition_kit/data-juicer)] │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ hpo_config             │ None                                                                                                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ project_name           │ 'Data-Juicer-recipes-alpaca-cot-en'                                                                                                                           │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ executor_type          │ 'default'                                                                                                                                                     │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_path           │ '../data/raw_data/raw_data_en.jsonl'                                                                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_path            │ '../data/proc_data/proc_data_en.jsonl'                                                                                                                        │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_shard_size      │ 0                                                                                                                                                             │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_in_parallel     │ False                                                                                                                                                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ np                     │ 72                                                                                                                                                            │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ text_keys              │ 'text'                                                                                                                                                        │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ image_key              │ 'images'                                                                                                                                                      │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ image_special_token    │ '<__dj__image>'                                                                                                                                               │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ eoc_special_token      │ '<|__dj__eoc|>'                                                                                                                                               │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ suffixes               │ []                                                                                                                                                            │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ use_cache              │ True                                                                                                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ ds_cache_dir           │ PosixPath('/home/kingxue/.cache/huggingface/datasets')                                                                                                        │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ cache_compress         │ None                                                                                                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ use_checkpoint         │ False                                                                                                                                                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ temp_dir               │ None                                                                                                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ open_tracer            │ True                                                                                                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ op_list_to_trace       │ []                                                                                                                                                            │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ trace_num              │ 10                                                                                                                                                            │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ op_fusion              │ False                                                                                                                                                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ process                │ [{'document_deduplicator': {'ignore_non_character': True,                                                                                                     │
│                        │                             'image_key': 'images',                                                                                                            │
│                        │                             'lowercase': True,                                                                                                                │
│                        │                             'text_key': 'text'}},                                                                                                             │
│                        │  {'clean_email_mapper': {'image_key': 'images', 'text_key': 'text'}},                                                                                         │
│                        │  {'punctuation_normalization_mapper': {'image_key': 'images',                                                                                                 │
│                        │                                        'text_key': 'text'}},                                                                                                  │
│                        │  {'clean_html_mapper': {'image_key': 'images', 'text_key': 'text'}},                                                                                          │
│                        │  {'clean_ip_mapper': {'image_key': 'images', 'text_key': 'text'}},                                                                                            │
│                        │  {'clean_links_mapper': {'image_key': 'images', 'text_key': 'text'}},                                                                                         │
│                        │  {'clean_copyright_mapper': {'image_key': 'images', 'text_key': 'text'}},                                                                                     │
│                        │  {'expand_macro_mapper': {'image_key': 'images', 'text_key': 'text'}},                                                                                        │
│                        │  {'fix_unicode_mapper': {'image_key': 'images', 'text_key': 'text'}},                                                                                         │
│                        │  {'alphanumeric_filter': {'image_key': 'images',                                                                                                              │
│                        │                           'max_ratio': 0.9,                                                                                                                   │
│                        │                           'min_ratio': 0.1,                                                                                                                   │
│                        │                           'text_key': 'text',                                                                                                                 │
│                        │                           'tokenization': False}},                                                                                                            │
│                        │  {'character_repetition_filter': {'image_key': 'images',                                                                                                      │
│                        │                                   'max_ratio': 0.6,                                                                                                           │
│                        │                                   'min_ratio': 0.0,                                                                                                           │
│                        │                                   'rep_len': 10,                                                                                                              │
│                        │                                   'text_key': 'text'}},                                                                                                       │
│                        │  {'flagged_words_filter': {'flagged_words_dir': '/home/kingxue/.cache/data_juicer/assets',                                                                    │
│                        │                            'image_key': 'images',                                                                                                             │
│                        │                            'lang': 'en',                                                                                                                      │
│                        │                            'max_ratio': 0.017,                                                                                                                │
│                        │                            'text_key': 'text',                                                                                                                │
│                        │                            'tokenization': True,                                                                                                              │
│                        │                            'use_words_aug': False,                                                                                                            │
│                        │                            'words_aug_group_sizes': [2],                                                                                                      │
│                        │                            'words_aug_join_char': ''}},                                                                                                       │
│                        │  {'maximum_line_length_filter': {'image_key': 'images',                                                                                                       │
│                        │                                  'max_len': 9223372036854775807,                                                                                              │
│                        │                                  'min_len': 20,                                                                                                               │
│                        │                                  'text_key': 'text'}},                                                                                                        │
│                        │  {'text_length_filter': {'image_key': 'images',                                                                                                               │
│                        │                          'max_len': 9223372036854775807,                                                                                                      │
│                        │                          'min_len': 30,                                                                                                                       │
│                        │                          'text_key': 'text'}},                                                                                                                │
│                        │  {'perplexity_filter': {'image_key': 'images',                                                                                                                │
│                        │                         'lang': 'en',                                                                                                                         │
│                        │                         'max_ppl': 1500,                                                                                                                      │
│                        │                         'text_key': 'text'}},                                                                                                                 │
│                        │  {'special_characters_filter': {'image_key': 'images',                                                                                                        │
│                        │                                 'max_ratio': 0.25,                                                                                                            │
│                        │                                 'min_ratio': 0.0,                                                                                                             │
│                        │                                 'text_key': 'text'}},                                                                                                         │
│                        │  {'stopwords_filter': {'image_key': 'images',                                                                                                                 │
│                        │                        'lang': 'en',                                                                                                                          │
│                        │                        'min_ratio': 0.3,                                                                                                                      │
│                        │                        'stopwords_dir': './assets',                                                                                                           │
│                        │                        'text_key': 'text',                                                                                                                    │
│                        │                        'tokenization': False,                                                                                                                 │
│                        │                        'use_words_aug': False,                                                                                                                │
│                        │                        'words_aug_group_sizes': [2],                                                                                                          │
│                        │                        'words_aug_join_char': ''}},                                                                                                           │
│                        │  {'document_simhash_deduplicator': {'hamming_distance': 7,                                                                                                    │
│                        │                                     'ignore_pattern': '\\p{P}',                                                                                               │
│                        │                                     'image_key': 'images',                                                                                                    │
│                        │                                     'lowercase': True,                                                                                                        │
│                        │                                     'num_blocks': 9,                                                                                                          │
│                        │                                     'text_key': 'text',                                                                                                       │
│                        │                                     'tokenization': 'space',                                                                                                  │
│                        │                                     'window_size': 6}}]                                                                                                       │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ save_stats_in_one_file │ False                                                                                                                                                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ ray_address            │ 'auto'                                                                                                                                                        │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ work_dir               │ '../data/proc_data'                                                                                                                                           │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ timestamp              │ '20231123145728'                                                                                                                                              │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_dir            │ '/home/kingxue/PycharmProjects/ali_FT_Data_Ranker/competition_kit/data/raw_data'                                                                              │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ add_suffix             │ False                                                                                                                                                         │
╘════════════════════════╧═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╛
2023-11-23 14:57:35.748 | INFO     | data_juicer.config.config:config_backup:442 - Back up the input config file [/home/kingxue/PycharmProjects/ali_FT_Data_Ranker/competition_kit/data-juicer/configs/data_juicer_recipes/alpaca_cot/alpaca-cot-en-refine.yaml] into the work_dir [../data/proc_data]
2023-11-23 14:57:35.757 | INFO     | data_juicer.config.config:display_config:463 - Configuration table: 
╒════════════════════════╤═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╕
│ key                    │ values                                                                                                                                                        │
╞════════════════════════╪═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╡
│ config                 │ [Path_fr(configs/data_juicer_recipes/alpaca_cot/alpaca-cot-en-refine.yaml, cwd=/home/kingxue/PycharmProjects/ali_FT_Data_Ranker/competition_kit/data-juicer)] │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ hpo_config             │ None                                                                                                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ project_name           │ 'Data-Juicer-recipes-alpaca-cot-en'                                                                                                                           │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ executor_type          │ 'default'                                                                                                                                                     │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_path           │ '../data/raw_data/raw_data_en.jsonl'                                                                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_path            │ '../data/proc_data/proc_data_en.jsonl'                                                                                                                        │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_shard_size      │ 0                                                                                                                                                             │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_in_parallel     │ False                                                                                                                                                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ np                     │ 72                                                                                                                                                            │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ text_keys              │ 'text'                                                                                                                                                        │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ image_key              │ 'images'                                                                                                                                                      │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ image_special_token    │ '<__dj__image>'                                                                                                                                               │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ eoc_special_token      │ '<|__dj__eoc|>'                                                                                                                                               │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ suffixes               │ []                                                                                                                                                            │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ use_cache              │ True                                                                                                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ ds_cache_dir           │ PosixPath('/home/kingxue/.cache/huggingface/datasets')                                                                                                        │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ cache_compress         │ None                                                                                                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ use_checkpoint         │ False                                                                                                                                                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ temp_dir               │ None                                                                                                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ open_tracer            │ True                                                                                                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ op_list_to_trace       │ []                                                                                                                                                            │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ trace_num              │ 10                                                                                                                                                            │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ op_fusion              │ False                                                                                                                                                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ process                │ [{'document_deduplicator': {'ignore_non_character': True,                                                                                                     │
│                        │                             'image_key': 'images',                                                                                                            │
│                        │                             'lowercase': True,                                                                                                                │
│                        │                             'text_key': 'text'}},                                                                                                             │
│                        │  {'clean_email_mapper': {'image_key': 'images', 'text_key': 'text'}},                                                                                         │
│                        │  {'punctuation_normalization_mapper': {'image_key': 'images',                                                                                                 │
│                        │                                        'text_key': 'text'}},                                                                                                  │
│                        │  {'clean_html_mapper': {'image_key': 'images', 'text_key': 'text'}},                                                                                          │
│                        │  {'clean_ip_mapper': {'image_key': 'images', 'text_key': 'text'}},                                                                                            │
│                        │  {'clean_links_mapper': {'image_key': 'images', 'text_key': 'text'}},                                                                                         │
│                        │  {'clean_copyright_mapper': {'image_key': 'images', 'text_key': 'text'}},                                                                                     │
│                        │  {'expand_macro_mapper': {'image_key': 'images', 'text_key': 'text'}},                                                                                        │
│                        │  {'fix_unicode_mapper': {'image_key': 'images', 'text_key': 'text'}},                                                                                         │
│                        │  {'alphanumeric_filter': {'image_key': 'images',                                                                                                              │
│                        │                           'max_ratio': 0.9,                                                                                                                   │
│                        │                           'min_ratio': 0.1,                                                                                                                   │
│                        │                           'text_key': 'text',                                                                                                                 │
│                        │                           'tokenization': False}},                                                                                                            │
│                        │  {'character_repetition_filter': {'image_key': 'images',                                                                                                      │
│                        │                                   'max_ratio': 0.6,                                                                                                           │
│                        │                                   'min_ratio': 0.0,                                                                                                           │
│                        │                                   'rep_len': 10,                                                                                                              │
│                        │                                   'text_key': 'text'}},                                                                                                       │
│                        │  {'flagged_words_filter': {'flagged_words_dir': '/home/kingxue/.cache/data_juicer/assets',                                                                    │
│                        │                            'image_key': 'images',                                                                                                             │
│                        │                            'lang': 'en',                                                                                                                      │
│                        │                            'max_ratio': 0.017,                                                                                                                │
│                        │                            'text_key': 'text',                                                                                                                │
│                        │                            'tokenization': True,                                                                                                              │
│                        │                            'use_words_aug': False,                                                                                                            │
│                        │                            'words_aug_group_sizes': [2],                                                                                                      │
│                        │                            'words_aug_join_char': ''}},                                                                                                       │
│                        │  {'maximum_line_length_filter': {'image_key': 'images',                                                                                                       │
│                        │                                  'max_len': 9223372036854775807,                                                                                              │
│                        │                                  'min_len': 20,                                                                                                               │
│                        │                                  'text_key': 'text'}},                                                                                                        │
│                        │  {'text_length_filter': {'image_key': 'images',                                                                                                               │
│                        │                          'max_len': 9223372036854775807,                                                                                                      │
│                        │                          'min_len': 30,                                                                                                                       │
│                        │                          'text_key': 'text'}},                                                                                                                │
│                        │  {'perplexity_filter': {'image_key': 'images',                                                                                                                │
│                        │                         'lang': 'en',                                                                                                                         │
│                        │                         'max_ppl': 1500,                                                                                                                      │
│                        │                         'text_key': 'text'}},                                                                                                                 │
│                        │  {'special_characters_filter': {'image_key': 'images',                                                                                                        │
│                        │                                 'max_ratio': 0.25,                                                                                                            │
│                        │                                 'min_ratio': 0.0,                                                                                                             │
│                        │                                 'text_key': 'text'}},                                                                                                         │
│                        │  {'stopwords_filter': {'image_key': 'images',                                                                                                                 │
│                        │                        'lang': 'en',                                                                                                                          │
│                        │                        'min_ratio': 0.3,                                                                                                                      │
│                        │                        'stopwords_dir': './assets',                                                                                                           │
│                        │                        'text_key': 'text',                                                                                                                    │
│                        │                        'tokenization': False,                                                                                                                 │
│                        │                        'use_words_aug': False,                                                                                                                │
│                        │                        'words_aug_group_sizes': [2],                                                                                                          │
│                        │                        'words_aug_join_char': ''}},                                                                                                           │
│                        │  {'document_simhash_deduplicator': {'hamming_distance': 7,                                                                                                    │
│                        │                                     'ignore_pattern': '\\p{P}',                                                                                               │
│                        │                                     'image_key': 'images',                                                                                                    │
│                        │                                     'lowercase': True,                                                                                                        │
│                        │                                     'num_blocks': 9,                                                                                                          │
│                        │                                     'text_key': 'text',                                                                                                       │
│                        │                                     'tokenization': 'space',                                                                                                  │
│                        │                                     'window_size': 6}}]                                                                                                       │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ save_stats_in_one_file │ False                                                                                                                                                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ ray_address            │ 'auto'                                                                                                                                                        │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ work_dir               │ '../data/proc_data'                                                                                                                                           │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ timestamp              │ '20231123145735'                                                                                                                                              │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_dir            │ '/home/kingxue/PycharmProjects/ali_FT_Data_Ranker/competition_kit/data/raw_data'                                                                              │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ add_suffix             │ False                                                                                                                                                         │
╘════════════════════════╧═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╛
2023-11-23 14:57:35.766 | INFO     | __main__:process_and_show_res:162 - =========Stage 2: process original data=========
2023-11-23 14:57:35.767 | INFO     | data_juicer.core.executor:__init__:40 - Using cache compression method: [None]
2023-11-23 14:57:35.767 | INFO     | data_juicer.core.executor:__init__:45 - Setting up data formatter...
2023-11-23 14:57:35.768 | INFO     | data_juicer.core.executor:__init__:67 - Preparing exporter...
2023-11-23 14:57:35.768 | INFO     | data_juicer.core.executor:__init__:75 - Preparing tracer...
2023-11-23 14:57:35.768 | INFO     | data_juicer.core.executor:__init__:79 - Trace for all ops.
2023-11-23 14:57:35.768 | INFO     | data_juicer.core.executor:run:94 - Loading dataset from data formatter...
2023-11-23 14:57:36.762 | INFO     | logging:handle:968 - Found cached dataset json (/home/kingxue/.cache/huggingface/datasets/json/default-080f8142f34d2b74/0.0.0/fe5dd6ea2639a6df622901539cb550cf8797e5a6b2dd7af1cf934bed8e233e6e)
  0%|          | 0/1 [00:00<?, ?it/s]100%|##########| 1/1 [00:01<00:00,  1.39s/it]100%|##########| 1/1 [00:01<00:00,  1.39s/it]
2023-11-23 14:57:38.181 | INFO     | data_juicer.format.formatter:unify_format:178 - Unifying the input dataset formats...
2023-11-23 14:57:38.181 | INFO     | data_juicer.format.formatter:unify_format:193 - There are 4459532 sample(s) in the original dataset.
2023-11-23 14:57:38.388 | INFO     | logging:handle:968 - Loading cached processed dataset at /home/kingxue/.cache/huggingface/datasets/json/default-080f8142f34d2b74/0.0.0/fe5dd6ea2639a6df622901539cb550cf8797e5a6b2dd7af1cf934bed8e233e6e/cache-3ed1fa0f3ee6eb3f_*_of_00072.arrow
2023-11-23 14:57:38.422 | INFO     | data_juicer.format.formatter:unify_format:207 - 4459532 samples left after filtering empty text.
2023-11-23 14:57:38.422 | INFO     | data_juicer.format.mixture_formatter:load_dataset:136 - sampled 4459532 from 4459532
2023-11-23 14:57:38.440 | INFO     | data_juicer.format.mixture_formatter:load_dataset:142 - There are 4459532 in final dataset
2023-11-23 14:57:38.442 | INFO     | data_juicer.core.executor:run:100 - Preparing process operators...
2023-11-23 14:57:38.444 | INFO     | data_juicer.utils.model_utils:prepare_sentencepiece_model:104 - Loading sentencepiece model...
2023-11-23 14:57:38.486 | INFO     | data_juicer.utils.model_utils:prepare_kenlm_model:122 - Loading kenlm language model...
2023-11-23 14:57:38.487 | INFO     | data_juicer.utils.model_utils:check_model:59 - Model [en.arpa.bin] not found . Downloading...
2023-11-23 14:58:02.030 | INFO     | data_juicer.config.config:config_backup:442 - Back up the input config file [/home/kingxue/PycharmProjects/ali_FT_Data_Ranker/competition_kit/data-juicer/configs/data_juicer_recipes/alpaca_cot/alpaca-cot-en-refine.yaml] into the work_dir [../data/proc_data]
2023-11-23 14:58:02.039 | INFO     | data_juicer.config.config:display_config:463 - Configuration table: 
╒════════════════════════╤═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╕
│ key                    │ values                                                                                                                                                        │
╞════════════════════════╪═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╡
│ config                 │ [Path_fr(configs/data_juicer_recipes/alpaca_cot/alpaca-cot-en-refine.yaml, cwd=/home/kingxue/PycharmProjects/ali_FT_Data_Ranker/competition_kit/data-juicer)] │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ hpo_config             │ None                                                                                                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ project_name           │ 'Data-Juicer-recipes-alpaca-cot-en'                                                                                                                           │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ executor_type          │ 'default'                                                                                                                                                     │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_path           │ '../data/raw_data/raw_data_en.jsonl'                                                                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_path            │ '../data/proc_data/proc_data_en.jsonl'                                                                                                                        │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_shard_size      │ 0                                                                                                                                                             │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_in_parallel     │ False                                                                                                                                                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ np                     │ 72                                                                                                                                                            │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ text_keys              │ 'text'                                                                                                                                                        │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ image_key              │ 'images'                                                                                                                                                      │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ image_special_token    │ '<__dj__image>'                                                                                                                                               │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ eoc_special_token      │ '<|__dj__eoc|>'                                                                                                                                               │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ suffixes               │ []                                                                                                                                                            │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ use_cache              │ True                                                                                                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ ds_cache_dir           │ PosixPath('/home/kingxue/.cache/huggingface/datasets')                                                                                                        │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ cache_compress         │ None                                                                                                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ use_checkpoint         │ False                                                                                                                                                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ temp_dir               │ None                                                                                                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ open_tracer            │ True                                                                                                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ op_list_to_trace       │ []                                                                                                                                                            │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ trace_num              │ 10                                                                                                                                                            │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ op_fusion              │ False                                                                                                                                                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ process                │ [{'document_deduplicator': {'ignore_non_character': True,                                                                                                     │
│                        │                             'image_key': 'images',                                                                                                            │
│                        │                             'lowercase': True,                                                                                                                │
│                        │                             'text_key': 'text'}},                                                                                                             │
│                        │  {'clean_email_mapper': {'image_key': 'images', 'text_key': 'text'}},                                                                                         │
│                        │  {'punctuation_normalization_mapper': {'image_key': 'images',                                                                                                 │
│                        │                                        'text_key': 'text'}},                                                                                                  │
│                        │  {'clean_html_mapper': {'image_key': 'images', 'text_key': 'text'}},                                                                                          │
│                        │  {'clean_ip_mapper': {'image_key': 'images', 'text_key': 'text'}},                                                                                            │
│                        │  {'clean_links_mapper': {'image_key': 'images', 'text_key': 'text'}},                                                                                         │
│                        │  {'clean_copyright_mapper': {'image_key': 'images', 'text_key': 'text'}},                                                                                     │
│                        │  {'expand_macro_mapper': {'image_key': 'images', 'text_key': 'text'}},                                                                                        │
│                        │  {'fix_unicode_mapper': {'image_key': 'images', 'text_key': 'text'}},                                                                                         │
│                        │  {'alphanumeric_filter': {'image_key': 'images',                                                                                                              │
│                        │                           'max_ratio': 0.9,                                                                                                                   │
│                        │                           'min_ratio': 0.1,                                                                                                                   │
│                        │                           'text_key': 'text',                                                                                                                 │
│                        │                           'tokenization': False}},                                                                                                            │
│                        │  {'character_repetition_filter': {'image_key': 'images',                                                                                                      │
│                        │                                   'max_ratio': 0.6,                                                                                                           │
│                        │                                   'min_ratio': 0.0,                                                                                                           │
│                        │                                   'rep_len': 10,                                                                                                              │
│                        │                                   'text_key': 'text'}},                                                                                                       │
│                        │  {'flagged_words_filter': {'flagged_words_dir': '/home/kingxue/.cache/data_juicer/assets',                                                                    │
│                        │                            'image_key': 'images',                                                                                                             │
│                        │                            'lang': 'en',                                                                                                                      │
│                        │                            'max_ratio': 0.017,                                                                                                                │
│                        │                            'text_key': 'text',                                                                                                                │
│                        │                            'tokenization': True,                                                                                                              │
│                        │                            'use_words_aug': False,                                                                                                            │
│                        │                            'words_aug_group_sizes': [2],                                                                                                      │
│                        │                            'words_aug_join_char': ''}},                                                                                                       │
│                        │  {'maximum_line_length_filter': {'image_key': 'images',                                                                                                       │
│                        │                                  'max_len': 9223372036854775807,                                                                                              │
│                        │                                  'min_len': 20,                                                                                                               │
│                        │                                  'text_key': 'text'}},                                                                                                        │
│                        │  {'text_length_filter': {'image_key': 'images',                                                                                                               │
│                        │                          'max_len': 9223372036854775807,                                                                                                      │
│                        │                          'min_len': 30,                                                                                                                       │
│                        │                          'text_key': 'text'}},                                                                                                                │
│                        │  {'perplexity_filter': {'image_key': 'images',                                                                                                                │
│                        │                         'lang': 'en',                                                                                                                         │
│                        │                         'max_ppl': 1500,                                                                                                                      │
│                        │                         'text_key': 'text'}},                                                                                                                 │
│                        │  {'special_characters_filter': {'image_key': 'images',                                                                                                        │
│                        │                                 'max_ratio': 0.25,                                                                                                            │
│                        │                                 'min_ratio': 0.0,                                                                                                             │
│                        │                                 'text_key': 'text'}},                                                                                                         │
│                        │  {'stopwords_filter': {'image_key': 'images',                                                                                                                 │
│                        │                        'lang': 'en',                                                                                                                          │
│                        │                        'min_ratio': 0.3,                                                                                                                      │
│                        │                        'stopwords_dir': './assets',                                                                                                           │
│                        │                        'text_key': 'text',                                                                                                                    │
│                        │                        'tokenization': False,                                                                                                                 │
│                        │                        'use_words_aug': False,                                                                                                                │
│                        │                        'words_aug_group_sizes': [2],                                                                                                          │
│                        │                        'words_aug_join_char': ''}},                                                                                                           │
│                        │  {'document_simhash_deduplicator': {'hamming_distance': 7,                                                                                                    │
│                        │                                     'ignore_pattern': '\\p{P}',                                                                                               │
│                        │                                     'image_key': 'images',                                                                                                    │
│                        │                                     'lowercase': True,                                                                                                        │
│                        │                                     'num_blocks': 9,                                                                                                          │
│                        │                                     'text_key': 'text',                                                                                                       │
│                        │                                     'tokenization': 'space',                                                                                                  │
│                        │                                     'window_size': 6}}]                                                                                                       │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ save_stats_in_one_file │ False                                                                                                                                                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ ray_address            │ 'auto'                                                                                                                                                        │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ work_dir               │ '../data/proc_data'                                                                                                                                           │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ timestamp              │ '20231123145802'                                                                                                                                              │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_dir            │ '/home/kingxue/PycharmProjects/ali_FT_Data_Ranker/competition_kit/data/raw_data'                                                                              │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ add_suffix             │ False                                                                                                                                                         │
╘════════════════════════╧═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╛
2023-11-23 14:58:02.049 | INFO     | __main__:analyze_and_show_res:136 - =========Stage 1: analyze original data=========
2023-11-23 14:58:02.049 | INFO     | data_juicer.core.analyser:__init__:38 - Using cache compression method: [None]
2023-11-23 14:58:02.049 | INFO     | data_juicer.core.analyser:__init__:43 - Setting up data formatter...
2023-11-23 14:58:02.050 | INFO     | data_juicer.core.analyser:__init__:52 - Preparing exporter...
2023-11-23 14:58:02.050 | INFO     | data_juicer.core.analyser:run:73 - Loading dataset from data formatter...
2023-11-23 14:58:03.503 | INFO     | logging:handle:968 - Found cached dataset json (/home/kingxue/.cache/huggingface/datasets/json/default-080f8142f34d2b74/0.0.0/fe5dd6ea2639a6df622901539cb550cf8797e5a6b2dd7af1cf934bed8e233e6e)
  0%|          | 0/1 [00:00<?, ?it/s]100%|##########| 1/1 [00:00<00:00,  9.90it/s]100%|##########| 1/1 [00:00<00:00,  9.82it/s]
2023-11-23 14:58:03.782 | INFO     | data_juicer.format.formatter:unify_format:178 - Unifying the input dataset formats...
2023-11-23 14:58:03.784 | INFO     | data_juicer.format.formatter:unify_format:193 - There are 4459532 sample(s) in the original dataset.
2023-11-23 14:58:04.000 | INFO     | logging:handle:968 - Loading cached processed dataset at /home/kingxue/.cache/huggingface/datasets/json/default-080f8142f34d2b74/0.0.0/fe5dd6ea2639a6df622901539cb550cf8797e5a6b2dd7af1cf934bed8e233e6e/cache-3ed1fa0f3ee6eb3f_*_of_00072.arrow
2023-11-23 14:58:04.044 | INFO     | data_juicer.format.formatter:unify_format:207 - 4459532 samples left after filtering empty text.
2023-11-23 14:58:04.045 | INFO     | data_juicer.format.mixture_formatter:load_dataset:136 - sampled 4459532 from 4459532
2023-11-23 14:58:04.066 | INFO     | data_juicer.format.mixture_formatter:load_dataset:142 - There are 4459532 in final dataset
2023-11-23 14:58:04.068 | INFO     | data_juicer.core.analyser:run:79 - Preparing process operators...
2023-11-23 14:58:04.069 | INFO     | data_juicer.utils.model_utils:prepare_kenlm_model:122 - Loading kenlm language model...
2023-11-23 14:58:04.070 | INFO     | data_juicer.utils.model_utils:check_model:59 - Model [en.arpa.bin] not found . Downloading...
2023-11-23 14:58:11.053 | INFO     | data_juicer.config.config:config_backup:442 - Back up the input config file [/home/kingxue/PycharmProjects/ali_FT_Data_Ranker/competition_kit/data-juicer/configs/data_juicer_recipes/alpaca_cot/alpaca-cot-en-refine.yaml] into the work_dir [../data/proc_data]
2023-11-23 14:58:11.067 | INFO     | data_juicer.config.config:display_config:463 - Configuration table: 
╒════════════════════════╤═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╕
│ key                    │ values                                                                                                                                                        │
╞════════════════════════╪═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╡
│ config                 │ [Path_fr(configs/data_juicer_recipes/alpaca_cot/alpaca-cot-en-refine.yaml, cwd=/home/kingxue/PycharmProjects/ali_FT_Data_Ranker/competition_kit/data-juicer)] │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ hpo_config             │ None                                                                                                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ project_name           │ 'Data-Juicer-recipes-alpaca-cot-en'                                                                                                                           │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ executor_type          │ 'default'                                                                                                                                                     │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_path           │ '../data/raw_data/raw_data_en.jsonl'                                                                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_path            │ '../data/proc_data/proc_data_en.jsonl'                                                                                                                        │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_shard_size      │ 0                                                                                                                                                             │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_in_parallel     │ False                                                                                                                                                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ np                     │ 72                                                                                                                                                            │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ text_keys              │ 'text'                                                                                                                                                        │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ image_key              │ 'images'                                                                                                                                                      │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ image_special_token    │ '<__dj__image>'                                                                                                                                               │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ eoc_special_token      │ '<|__dj__eoc|>'                                                                                                                                               │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ suffixes               │ []                                                                                                                                                            │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ use_cache              │ True                                                                                                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ ds_cache_dir           │ PosixPath('/home/kingxue/.cache/huggingface/datasets')                                                                                                        │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ cache_compress         │ None                                                                                                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ use_checkpoint         │ False                                                                                                                                                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ temp_dir               │ None                                                                                                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ open_tracer            │ True                                                                                                                                                          │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ op_list_to_trace       │ []                                                                                                                                                            │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ trace_num              │ 10                                                                                                                                                            │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ op_fusion              │ False                                                                                                                                                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ process                │ [{'document_deduplicator': {'ignore_non_character': True,                                                                                                     │
│                        │                             'image_key': 'images',                                                                                                            │
│                        │                             'lowercase': True,                                                                                                                │
│                        │                             'text_key': 'text'}},                                                                                                             │
│                        │  {'clean_email_mapper': {'image_key': 'images', 'text_key': 'text'}},                                                                                         │
│                        │  {'punctuation_normalization_mapper': {'image_key': 'images',                                                                                                 │
│                        │                                        'text_key': 'text'}},                                                                                                  │
│                        │  {'clean_html_mapper': {'image_key': 'images', 'text_key': 'text'}},                                                                                          │
│                        │  {'clean_ip_mapper': {'image_key': 'images', 'text_key': 'text'}},                                                                                            │
│                        │  {'clean_links_mapper': {'image_key': 'images', 'text_key': 'text'}},                                                                                         │
│                        │  {'clean_copyright_mapper': {'image_key': 'images', 'text_key': 'text'}},                                                                                     │
│                        │  {'expand_macro_mapper': {'image_key': 'images', 'text_key': 'text'}},                                                                                        │
│                        │  {'fix_unicode_mapper': {'image_key': 'images', 'text_key': 'text'}},                                                                                         │
│                        │  {'alphanumeric_filter': {'image_key': 'images',                                                                                                              │
│                        │                           'max_ratio': 0.9,                                                                                                                   │
│                        │                           'min_ratio': 0.1,                                                                                                                   │
│                        │                           'text_key': 'text',                                                                                                                 │
│                        │                           'tokenization': False}},                                                                                                            │
│                        │  {'character_repetition_filter': {'image_key': 'images',                                                                                                      │
│                        │                                   'max_ratio': 0.6,                                                                                                           │
│                        │                                   'min_ratio': 0.0,                                                                                                           │
│                        │                                   'rep_len': 10,                                                                                                              │
│                        │                                   'text_key': 'text'}},                                                                                                       │
│                        │  {'flagged_words_filter': {'flagged_words_dir': '/home/kingxue/.cache/data_juicer/assets',                                                                    │
│                        │                            'image_key': 'images',                                                                                                             │
│                        │                            'lang': 'en',                                                                                                                      │
│                        │                            'max_ratio': 0.017,                                                                                                                │
│                        │                            'text_key': 'text',                                                                                                                │
│                        │                            'tokenization': True,                                                                                                              │
│                        │                            'use_words_aug': False,                                                                                                            │
│                        │                            'words_aug_group_sizes': [2],                                                                                                      │
│                        │                            'words_aug_join_char': ''}},                                                                                                       │
│                        │  {'maximum_line_length_filter': {'image_key': 'images',                                                                                                       │
│                        │                                  'max_len': 9223372036854775807,                                                                                              │
│                        │                                  'min_len': 20,                                                                                                               │
│                        │                                  'text_key': 'text'}},                                                                                                        │
│                        │  {'text_length_filter': {'image_key': 'images',                                                                                                               │
│                        │                          'max_len': 9223372036854775807,                                                                                                      │
│                        │                          'min_len': 30,                                                                                                                       │
│                        │                          'text_key': 'text'}},                                                                                                                │
│                        │  {'perplexity_filter': {'image_key': 'images',                                                                                                                │
│                        │                         'lang': 'en',                                                                                                                         │
│                        │                         'max_ppl': 1500,                                                                                                                      │
│                        │                         'text_key': 'text'}},                                                                                                                 │
│                        │  {'special_characters_filter': {'image_key': 'images',                                                                                                        │
│                        │                                 'max_ratio': 0.25,                                                                                                            │
│                        │                                 'min_ratio': 0.0,                                                                                                             │
│                        │                                 'text_key': 'text'}},                                                                                                         │
│                        │  {'stopwords_filter': {'image_key': 'images',                                                                                                                 │
│                        │                        'lang': 'en',                                                                                                                          │
│                        │                        'min_ratio': 0.3,                                                                                                                      │
│                        │                        'stopwords_dir': './assets',                                                                                                           │
│                        │                        'text_key': 'text',                                                                                                                    │
│                        │                        'tokenization': False,                                                                                                                 │
│                        │                        'use_words_aug': False,                                                                                                                │
│                        │                        'words_aug_group_sizes': [2],                                                                                                          │
│                        │                        'words_aug_join_char': ''}},                                                                                                           │
│                        │  {'document_simhash_deduplicator': {'hamming_distance': 7,                                                                                                    │
│                        │                                     'ignore_pattern': '\\p{P}',                                                                                               │
│                        │                                     'image_key': 'images',                                                                                                    │
│                        │                                     'lowercase': True,                                                                                                        │
│                        │                                     'num_blocks': 9,                                                                                                          │
│                        │                                     'text_key': 'text',                                                                                                       │
│                        │                                     'tokenization': 'space',                                                                                                  │
│                        │                                     'window_size': 6}}]                                                                                                       │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ save_stats_in_one_file │ False                                                                                                                                                         │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ ray_address            │ 'auto'                                                                                                                                                        │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ work_dir               │ '../data/proc_data'                                                                                                                                           │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ timestamp              │ '20231123145811'                                                                                                                                              │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_dir            │ '/home/kingxue/PycharmProjects/ali_FT_Data_Ranker/competition_kit/data/raw_data'                                                                              │
├────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ add_suffix             │ False                                                                                                                                                         │
╘════════════════════════╧═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╛
2023-11-23 14:58:11.078 | INFO     | __main__:analyze_and_show_res:136 - =========Stage 1: analyze original data=========
2023-11-23 14:58:11.078 | INFO     | data_juicer.core.analyser:__init__:38 - Using cache compression method: [None]
2023-11-23 14:58:11.079 | INFO     | data_juicer.core.analyser:__init__:43 - Setting up data formatter...
2023-11-23 14:58:11.079 | INFO     | data_juicer.core.analyser:__init__:52 - Preparing exporter...
2023-11-23 14:58:11.080 | INFO     | data_juicer.core.analyser:run:73 - Loading dataset from data formatter...
2023-11-23 14:58:12.295 | INFO     | logging:handle:968 - Found cached dataset json (/home/kingxue/.cache/huggingface/datasets/json/default-080f8142f34d2b74/0.0.0/fe5dd6ea2639a6df622901539cb550cf8797e5a6b2dd7af1cf934bed8e233e6e)
  0%|          | 0/1 [00:00<?, ?it/s]100%|##########| 1/1 [00:00<00:00,  9.42it/s]100%|##########| 1/1 [00:00<00:00,  9.35it/s]
2023-11-23 14:58:12.427 | INFO     | data_juicer.format.formatter:unify_format:178 - Unifying the input dataset formats...
2023-11-23 14:58:12.428 | INFO     | data_juicer.format.formatter:unify_format:193 - There are 4459532 sample(s) in the original dataset.
2023-11-23 14:58:12.661 | INFO     | logging:handle:968 - Loading cached processed dataset at /home/kingxue/.cache/huggingface/datasets/json/default-080f8142f34d2b74/0.0.0/fe5dd6ea2639a6df622901539cb550cf8797e5a6b2dd7af1cf934bed8e233e6e/cache-3ed1fa0f3ee6eb3f_*_of_00072.arrow
2023-11-23 14:58:12.887 | INFO     | data_juicer.format.formatter:unify_format:207 - 4459532 samples left after filtering empty text.
2023-11-23 14:58:12.888 | INFO     | data_juicer.format.mixture_formatter:load_dataset:136 - sampled 4459532 from 4459532
2023-11-23 14:58:12.914 | INFO     | data_juicer.format.mixture_formatter:load_dataset:142 - There are 4459532 in final dataset
2023-11-23 14:58:12.915 | INFO     | data_juicer.core.analyser:run:79 - Preparing process operators...
2023-11-23 14:58:12.917 | INFO     | data_juicer.utils.model_utils:prepare_kenlm_model:122 - Loading kenlm language model...
2023-11-23 14:58:12.918 | INFO     | data_juicer.utils.model_utils:check_model:59 - Model [en.arpa.bin] not found . Downloading...
b''b'  Stopping...\n'b'  Stopping...\n'